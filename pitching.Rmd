Author: Trey Chase
Date: sys.date()


```{r loading libraries, echo=FALSE}
library(ggplot2)
library(dplyr)
library(readr)
library(GGally)
library(tidyr)
```


```{r loading data}
df <- read_csv("/Users/treychase/Downloads/poi_metrics.csv")
```
```{r df structure}
dim(df)
head(df)
summary(df)
```

```{r data selection}
#obtaining all quantitative variables, dropping all rows with na
df = df |>
  select_if(
    is.numeric, 
  ) |>
  drop_na() |>
  select(
    -(session) #removing session column
  )
```


```{r correlation plot, echo=FALSE}
#checking multi collinearity condition, as well as obtaining the most correlated value with pitch speed
library(ggcorrplot)
corr_matrix = cor(df)
diag(corr_matrix) = NA

first_column <- corr_matrix[,1]
max_value <- max(first_column, na.rm = TRUE)
max_var <- rownames(corr_matrix)[which(first_column == max_value)]


max_value
max_var
```


```{r plotting most correlated variable}
ggplot(df, aes(x=elbow_transfer_fp_br, y=pitch_speed_mph)) + 
  geom_point() +
  geom_smooth(method = "lm", color="blue") +
  labs(
    x = "Elbow Transfer FP",
    y= "Pitch Speed MPH",
    title = "Elbow Transfer Force vs. Velocity"
  )
```

```{r plotting transformed}
ggplot(df, aes(x=(elbow_transfer_fp_br), y=log(pitch_speed_mph))) + 
  geom_point() +
  geom_smooth(method = "lm", color="blue") +
  labs(
    x = "Elbow Transfer Force Plate",
    y= "Pitch Speed MPH",
    title = "Elbow Transfer Force vs. Log Velocity"
  )
```






```{r transformation plot}
model = lm(pitch_speed_mph ~ elbow_transfer_fp_br, data=df)
summary(model)
```


