Author: Trey Chase
Date: sys.date()


```{r loading libraries, echo=FALSE}
library(ggplot2)
library(dplyr)
library(readr)
```


```{r loading data}
df <- read_csv("/Users/treychase/Downloads/poi_metrics.csv")
```
```{r df structure}
dim(df)
head(df)
summary(df)
```

```{r data filtering}
df <- df %>%
  select(
    pitch_speed_mph,
    rotation_hip_shoulder_separation_fp,
    elbow_flexion_fp,
    elbow_pronation_fp,
    shoulder_horizontal_abduction_fp,
    shoulder_external_rotation_fp,
  )
```

```{r plotting, echo=FALSE}
ggplot(df) + 
  geom_boxplot(aes(x=pitch_speed_mph))
```

```{r fitting the model, echo=FALSE}
#fitting the model with pitch speed as the response variable, using Rs "lm" function
pitch_speed_model <- lm(pitch_speed_mph ~ rotation_hip_shoulder_separation_fp + 
    elbow_flexion_fp +
    elbow_pronation_fp +
    shoulder_horizontal_abduction_fp +
    shoulder_external_rotation_fp, data = df)
```


```{r correlation plot}
#checking multi-collinearity condition
library(ggcorrplot)
corr_matrix = cor(df)
ggcorrplot(corr_matrix, hc.order = TRUE, type = "lower", lab = TRUE)
```


```{r residual historgram}
residuals = pitch_speed_model$residuals
hist(residuals)
```

```{r normal plot of residuals}
qqnorm(residuals)
qqline(residuals)
#checking for normality in the residuals, looks approximately normal
```


